# ğŸ“ æ–‡ä»¶æ¶æ„è®¾è®¡è¯´æ˜

## ğŸ—ï¸ **ç›®å½•ç»“æ„æ¦‚è§ˆ**

`feature_extraction_scenario/` é¡¹ç›®ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š

```
feature_extraction_scenario/
â”œâ”€â”€ core_logic/                    # æ ¸å¿ƒç‰¹å¾æå–é€»è¾‘ä¸æ¨¡å‹
â”‚   â”œâ”€â”€ models/                    # æœºå™¨å­¦ä¹ æ¨¡å‹ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ base_model/            # åŸºç¡€æ¨¡å‹ (Transformer, GNN, Fusion, Head)
â”‚   â”‚   â”œâ”€â”€ text_encoder/          # æ–‡æœ¬ç¼–ç æ¨¡å‹ (BERT)
â”‚   â”‚   â””â”€â”€ structure_encoder/     # ç»“æ„åŒ–æ•°æ®æ¨¡å‹ (LightGBM)
â”‚   â”œâ”€â”€ train_pipeline/            # æ¨¡å‹è®­ç»ƒæµæ°´çº¿ (trainer.py, multimodal_model.py)
â”‚   â”œâ”€â”€ dataset_pipeline.py        # æ•°æ®é›†å¤„ç†å’Œç‰¹å¾æå–ä¸»æµæ°´çº¿
â”‚   â”œâ”€â”€ encoder.py                 # äº‹ä»¶ç¼–ç å™¨
â”‚   â”œâ”€â”€ utils.py                   # é€šç”¨å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ temporal.py                # æ—¶é—´ç‰¹å¾ç›¸å…³å¤„ç†
â”‚   â”œâ”€â”€ user_context.py            # ç”¨æˆ·ä¸Šä¸‹æ–‡åŠé£é™©ç”»åƒ
â”‚   â”œâ”€â”€ config.py                  # é…ç½®æ–‡ä»¶ (ModelConfigç­‰)
â”‚   â”œâ”€â”€ email_features.py          # é‚®ä»¶ç‰¹å¾æå– (ç¤ºä¾‹)
â”‚   â”œâ”€â”€ http_features.py           # HTTPç‰¹å¾æå– (ç¤ºä¾‹)
â”‚   â”œâ”€â”€ ...                        # å…¶ä»–ç‰¹å®šäº‹ä»¶ç±»å‹ç‰¹å¾æå–æ¨¡å—
â”‚   â””â”€â”€ __init__.py
â”œâ”€â”€ docs/                          # é¡¹ç›®æ–‡æ¡£
â”‚   â”œâ”€â”€ FILE_STRUCTURE.md          # æœ¬æ–‡ä»¶ - é¡¹ç›®æ–‡ä»¶ç»“æ„è¯´æ˜
â”‚   â”œâ”€â”€ PIPELINE_USAGE.md          # æµæ°´çº¿ä½¿ç”¨æŒ‡å—
â”‚   â”œâ”€â”€ ARCHITECTURE.md            # ç³»ç»Ÿæ¶æ„è®¾è®¡
â”‚   â”œâ”€â”€ API_REFERENCE.md           # APIå‚è€ƒï¼ˆå¦‚æœé€‚ç”¨ï¼‰
â”‚   â”œâ”€â”€ DATA_SAFETY_GUIDE.md       # æ•°æ®å®‰å…¨æŒ‡å—
â”‚   â”œâ”€â”€ SECURITY_UPDATE_SUMMARY.md # å®‰å…¨æ›´æ–°æ€»ç»“
â”‚   â””â”€â”€ README.md                  # docsç›®å½•è¯´æ˜
â”œâ”€â”€ output/                        # å­˜æ”¾æ‰€æœ‰ç”Ÿæˆçš„è¾“å‡ºæ–‡ä»¶ (è¢« .gitignore å¿½ç•¥)
â”‚   â”œâ”€â”€ checkpoints/               # æ¨¡å‹è®­ç»ƒçš„æ£€æŸ¥ç‚¹
â”‚   â”œâ”€â”€ exploration_results/       # æ•°æ®æ¢ç´¢å’Œå®éªŒç»“æœ
â”‚   â”œâ”€â”€ tmp/                       # ä¸´æ—¶æ–‡ä»¶
â”‚   â””â”€â”€ README.md                  # outputç›®å½•è¯´æ˜
â”œâ”€â”€ scripts/                       # å¯æ‰§è¡Œè„šæœ¬ã€è¾…åŠ©å·¥å…·è„šæœ¬
â”‚   â”œâ”€â”€ data_exploration.py        # (ç¤ºä¾‹) æ•°æ®æ¢ç´¢è„šæœ¬
â”‚   â”œâ”€â”€ run_pipeline_cli.py        # (ç¤ºä¾‹) å‘½ä»¤è¡Œè¿è¡Œæµæ°´çº¿çš„è„šæœ¬
â”‚   â””â”€â”€ __init__.py
â”œâ”€â”€ tests/                         # æµ‹è¯•ä»£ç 
â”‚   â”œâ”€â”€ sample_test_data/          # å­˜æ”¾æµ‹è¯•æµç¨‹ä½¿ç”¨çš„æ ·æœ¬æ•°æ® (å¦‚ .csv æ–‡ä»¶)
â”‚   â”‚   â””â”€â”€ answers/               # (ç¤ºä¾‹) æµ‹è¯•ç”¨æ¶æ„ç”¨æˆ·æ ‡ç­¾
â”‚   â”œâ”€â”€ backup_data/               # test_pipeline.py è‡ªåŠ¨åˆ›å»ºçš„çœŸå®æ•°æ®å¤‡ä»½ç›®å½•
â”‚   â”œâ”€â”€ test_pipeline.py           # æµ‹è¯• dataset_pipeline.py
â”‚   â”œâ”€â”€ test_models.py             # æµ‹è¯• core_logic/models/ ä¸­çš„å„ä¸ªæ¨¡å‹æ¨¡å—
â”‚   â”œâ”€â”€ test_complete_system.py    # æµ‹è¯•å®Œæ•´çš„æ¨¡å‹é›†æˆå’Œæµç¨‹
â”‚   â””â”€â”€ __init__.py
â”œâ”€â”€ README.md                      # é¡¹ç›®ä¸»READMEæ–‡ä»¶
â”œâ”€â”€ .gitignore                     # Gitå¿½ç•¥é…ç½®æ–‡ä»¶
â””â”€â”€ backup_YYYYMMDD_HHMMSS/        # (ç¤ºä¾‹)æ—§çš„å¤‡ä»½ç›®å½• (è¢« .gitignore å¿½ç•¥)
```

## ğŸ¯ **æ ¸å¿ƒç›®å½•è¯´æ˜**

*   **`core_logic/`**: åŒ…å«é¡¹ç›®çš„æ‰€æœ‰æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ã€‚
    *   `models/`: å­˜æ”¾æ‰€æœ‰æœºå™¨å­¦ä¹ æ¨¡å‹çš„å®šä¹‰ã€‚æ‹†åˆ†ä¸º `base_model` (å¯å¤ç”¨ç»„ä»¶) å’Œç‰¹å®šç±»å‹çš„ç¼–ç å™¨/åˆ†æ”¯ã€‚
    *   `train_pipeline/`: åŒ…å«ç”¨äºè®­ç»ƒå¤šæ¨¡æ€æ¨¡å‹çš„ä»£ç ã€‚
    *   `dataset_pipeline.py`: è´Ÿè´£ä»åŸå§‹æ•°æ®åˆ°æœ€ç»ˆç‰¹å¾çš„å®Œæ•´å¤„ç†æµç¨‹ã€‚
    *   `encoder.py`, `utils.py`, ç­‰: æä¾›æµæ°´çº¿æ‰€éœ€çš„è¾…åŠ©åŠŸèƒ½å’Œç‰¹å®šç‰¹å¾æå–é€»è¾‘ã€‚
*   **`docs/`**: å­˜æ”¾æ‰€æœ‰é¡¹ç›®ç›¸å…³çš„Markdownæ–‡æ¡£ï¼Œç”¨äºè§£é‡Šé¡¹ç›®ç»“æ„ã€ç”¨æ³•ã€è®¾è®¡å†³ç­–ç­‰ã€‚
*   **`output/`**: æ‰€æœ‰ç”±è„šæœ¬è¿è¡Œäº§ç”Ÿçš„è¾“å‡ºï¼ˆå¦‚æ¨¡å‹ã€ç»“æœã€ä¸´æ—¶æ–‡ä»¶ï¼‰éƒ½åº”ä¿å­˜åˆ°æ­¤ç›®å½•ã€‚æ­¤ç›®å½•é€šå¸¸è¢«æ·»åŠ åˆ° `.gitignore`ã€‚
*   **`scripts/`**: åŒ…å«ä¸€äº›ç”¨äºè¿è¡Œç‰¹å®šä»»åŠ¡ï¼ˆå¦‚æ•°æ®æ¢ç´¢ã€å¯åŠ¨è®­ç»ƒã€è¿è¡Œç‰¹å®šåˆ†æï¼‰çš„ç‹¬ç«‹è„šæœ¬ã€‚
*   **`tests/`**: åŒ…å«æ‰€æœ‰å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•å’Œç³»ç»Ÿæµ‹è¯•ã€‚
    *   `sample_test_data/`: ä¸ºæµ‹è¯•æä¾›å°å‹ã€å¯å¤ç°çš„æ•°æ®é›†ã€‚
    *   `test_pipeline.py`: ä¸“æ³¨äºæµ‹è¯•æ•°æ®å¤„ç†å’Œç‰¹å¾æå–æµæ°´çº¿çš„æ­£ç¡®æ€§ï¼Œå…¶ç”Ÿæˆçš„è¾“å‡ºä¼šè¿›å…¥ `feature_extraction_scenario/test_output/` (æ­¤ç›®å½•ä¹Ÿè¢« `.gitignore` å¿½ç•¥)ã€‚

## ğŸ”„ **æ•°æ®å’Œæ¨¡å‹æµå‘ (æ¦‚å¿µæ€§)**

1.  **åŸå§‹æ•°æ®**: å‡è®¾ä½äºé¡¹ç›®å¤–éƒ¨æˆ–ç‰¹å®šçš„ã€å—æ§çš„æ•°æ®å­˜å‚¨ä½ç½® (ä¾‹å¦‚ `../../data/r4.2/`)ã€‚
2.  **æµ‹è¯•æ•°æ®**: ä½äº `tests/sample_test_data/`ï¼Œç”¨äºå¼€å‘å’Œæµ‹è¯•ã€‚
3.  **`dataset_pipeline.py` (åœ¨ `core_logic/`)**: 
    *   è¯»å–åŸå§‹æ•°æ®æˆ–æµ‹è¯•æ•°æ®ã€‚
    *   è¿›è¡Œé¢„å¤„ç†ã€ç‰¹å¾ç¼–ç  (ä½¿ç”¨ `encoder.py` å’Œ `core_logic/*_features.py`)ã€‚
    *   ç”Ÿæˆä¸­é—´æ•°æ® (å¦‚ `DataByWeek/`, `NumDataByWeek/`) å’Œæœ€ç»ˆçš„ç‰¹å¾çº§åˆ«æ–‡ä»¶ (å¦‚ `WeekLevelFeatures/`)ã€‚è¿™äº›åœ¨å¸¸è§„è¿è¡Œæ—¶å¯èƒ½è¾“å‡ºåˆ°é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ç›¸åº”æ–‡ä»¶å¤¹ï¼ˆå·²è¢«gitå¿½ç•¥ï¼‰ï¼Œåœ¨ `test_pipeline.py` è¿è¡Œæ—¶è¾“å‡ºåˆ° `test_output/`ã€‚
4.  **æ¨¡å‹è®­ç»ƒ (ä½¿ç”¨ `core_logic/train_pipeline/` ä¸­çš„è„šæœ¬)**:
    *   åŠ è½½ `dataset_pipeline.py` ç”Ÿæˆçš„ç‰¹å¾ã€‚
    *   ä½¿ç”¨ `core_logic/models/` ä¸­å®šä¹‰çš„æ¨¡å‹è¿›è¡Œè®­ç»ƒã€‚
    *   å°†è®­ç»ƒå¥½çš„æ¨¡å‹æ£€æŸ¥ç‚¹ä¿å­˜åˆ° `output/checkpoints/`ã€‚
5.  **æ¨¡å‹æ¨ç†/åº”ç”¨**: 
    *   åŠ è½½ `output/checkpoints/` ä¸­çš„æ¨¡å‹ã€‚
    *   å¯¹æ–°æ•°æ®è¿›è¡Œç‰¹å¾æå–å’Œé¢„æµ‹ã€‚
    *   ç»“æœå¯èƒ½ä¿å­˜åˆ° `output/exploration_results/` æˆ–å…¶ä»–æŒ‡å®šä½ç½®ã€‚

## ğŸ› ï¸ **è„šæœ¬å’Œæµ‹è¯•è¿è¡Œ**

*   **è¿è¡Œæ ¸å¿ƒæµæ°´çº¿ (ç¤ºä¾‹)**:
    ```bash
    python feature_extraction_scenario/core_logic/dataset_pipeline.py # (å¯èƒ½éœ€è¦è°ƒæ•´å‚æ•°æˆ–é€šè¿‡åŒ…è£…è„šæœ¬è°ƒç”¨)
    ```
*   **è¿è¡Œæµ‹è¯•**:
    ```bash
    # ç¡®ä¿åœ¨ InProject/ ç›®å½•ä¸‹ï¼Œæˆ–è€…PYTHONPATHæ­£ç¡®è®¾ç½®
    python -m unittest discover -s feature_extraction_scenario/tests 
    # æˆ–è€…å•ç‹¬è¿è¡Œæµ‹è¯•æ–‡ä»¶
    python feature_extraction_scenario/tests/test_pipeline.py
    python feature_extraction_scenario/tests/test_models.py
    python feature_extraction_scenario/tests/test_complete_system.py
    ```
*   **è¿è¡Œè‡ªå®šä¹‰è„šæœ¬**:
    ```bash
    python feature_extraction_scenario/scripts/your_script_name.py
    ```

## ğŸ“¦ **ä¾èµ–ç®¡ç†**

(å»ºè®®æ·»åŠ é¡¹ç›®çš„ä¾èµ–ç®¡ç†æ–¹å¼ï¼Œä¾‹å¦‚ `requirements.txt` æˆ– `conda` ç¯å¢ƒæ–‡ä»¶è¯´æ˜)

---
*æ­¤æ–‡ä»¶ç»“æ„æ—¨åœ¨æé«˜é¡¹ç›®çš„æ¨¡å—åŒ–ã€å¯ç»´æŠ¤æ€§å’Œå¯æµ‹è¯•æ€§ã€‚* 